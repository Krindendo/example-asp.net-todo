<link rel="stylesheet" href="~/css/header-page.css" asp-append-version="true" />

<nav class="bg-white border-gray-200 p-2 sticky top-0 border-b border-gray-200 shadow inline-flex justify-end  items-center">
	<div class="inline-flex items-center gap-2 md:gap-2 md:container md:mx-auto md:justify-between">

		<button id="hamburger" type="button" class="ml-auto inline-flex h-10 w-10 items-center justify-center rounded-full border border-gray-400 p-2 text-sm text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 md:hidden" aria-label="Open menu">
			<span class="sr-only">Open main menu</span>
			<i class="fa-solid fa-bars text-xl"></i>
		</button>
		
		<ul class="hidden flex-col p-4 font-medium md:flex md:p-0 md:space-x-8 md:flex-row md:border-0 md:bg-white">
			<li>
				<a asp-controller="Home" asp-action="Index" class="block py-2 px-3 text-white bg-blue-700 rounded-sm md:bg-transparent md:text-blue-700 md:p-0" aria-current="page">Home</a>
			</li>
			<li class="relative">
				<button id="dropdownNavbarButton" data-dropdown-toggle="dropdownNavbar" class="flex items-center gap-2 justify-between w-full py-2 px-3 text-gray-900 rounded-sm hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0 md:w-auto">
					Product
					<i class="fa-solid fa-angle-down text-lg"></i>
				</button>
				<!-- Dropdown menu -->
				<div id="dropdownNavbar" class="z-10 hidden font-normal w-screen h-screen sm:h-max sm:bg-white divide-y divide-gray-100 sm:rounded-lg sm:shadow-sm sm:w-44">
					<ul class="py-2 text-sm text-gray-700" aria-labelledby="dropdownNavbarButton">
						<li>
							<a asp-controller="Home" asp-action="ProductCreate" class="block px-4 py-2 hover:bg-gray-100">Product Create</a>
						</li>
						<li>
							<a href="#" class="block px-4 py-2 hover:bg-gray-100">Settings</a>
						</li>
						<li>
							<a href="#" class="block px-4 py-2 hover:bg-gray-100">Earnings</a>
						</li>
					</ul>
				</div>
			</li>
			<li>
				<a asp-controller="Home" asp-action="Privacy" class="block py-2 px-3 text-gray-900 rounded-sm hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0">Privacy</a>
			</li>
			<li>
				<a asp-controller="Home" asp-action="DataTable" class="block py-2 px-3 text-gray-900 rounded-sm hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0">DataTable</a>
			</li>
			<li>
				<a asp-controller="Account" asp-action="Login" class="block py-2 px-3 text-gray-900 rounded-sm hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0">Login</a>
			</li>
		</ul>

		<partial name="_HeaderProfilePartialView" />

	</div>
</nav>

<div id="mobile-menu" class="mobile-menu" aria-hidden="true">
	<button id="close-btn" class="mobile-menu-close" aria-label="Close menu"><i class="fa-solid fa-xmark text-gray-500"></i></button>
	<div id="inner" class="overlay-inner">

		<!-- PANEL 0: ROOT -->
		<ul class="menu-panel">
			<li>
				<a asp-controller="Home" asp-action="Index" class="block w-full py-4 px-3 text-primary-600" aria-current="page">Home</a>
			</li>
			<li class="w-full">
				<button data-panel="header-panel-submenu-1" class="text-primary-600 inline-flex w-full items-center justify-between gap-1  px-3 py-4" type="button">
					<p>Product</p>
					<i class="fa-solid fa-angle-right text-md text-gray-500"></i>
				</button>
			</li>
			<li class="w-full">
				<button data-panel="header-panel-submenu-2" class="text-primary-600 inline-flex w-full items-center justify-between gap-1 px-3 py-4" type="button">
					<p>Product</p>
					<i class="fa-solid fa-angle-right text-md text-gray-500"></i>
				</button>
			</li>
			<li>
				<a asp-controller="Home" asp-action="Privacy" class="block py-4 px-3 text-primary-600 w-full hover:bg-gray-100">Privacy</a>
			</li>
			<li>
				<a asp-controller="Home" asp-action="DataTable" class="block py-4 px-3 text-primary-600 w-full hover:bg-gray-100">DataTable</a>
			</li>
			<li>
				<a asp-controller="Account" asp-action="Login" class="block py-4 px-3 text-primary-600 w-full hover:bg-gray-100">Login</a>
			</li>
		</ul>

		<ul id="header-panel-submenu-1" class="submenu-panel submenu-panel-inactive">
			<li class="back py-2">
				<button class="submenu-panel-back-button text-gray-600" type="button">
					<i class="fa-solid fa-angle-left text-md text-gray-500"></i>
					Product
				</button>
			</li>
			<li>
				<a asp-controller="Home" asp-action="ProductCreate" class="block px-4 py-2 text-primary-600 hover:bg-gray-100">Product Create</a>
			</li>
			<li>
				<a href="#" class="block px-4 py-2 text-primary-600 hover:bg-gray-100">Settings</a>
			</li>
			<li>
				<a href="#" class="block px-4 py-2 text-primary-600 hover:bg-gray-100">Earnings</a>
			</li>
		</ul>

		<ul id="header-panel-submenu-2" class="submenu-panel submenu-panel-inactive">
			<li class="back py-2">
				<button class="submenu-panel-back-button text-gray-600" type="button">
					<i class="fa-solid fa-angle-left text-md text-gray-500"></i>
					Product
				</button>
			</li>
			<li>
				<a href="#" class="block px-4 py-2 text-primary-600 hover:bg-gray-100">Settings</a>
			</li>
			<li>
				<a asp-controller="Home" asp-action="ProductCreate" class="block px-4 py-2 text-primary-600 hover:bg-gray-100">Product Create</a>
			</li>
			<li>
				<a href="#" class="block px-4 py-2 text-primary-600 hover:bg-gray-100">Earnings</a>
			</li>
		</ul>

	</div>
</div>

<script>
	(() => {
		const hamburger = document.getElementById('hamburger');
		const mobileMenu = document.getElementById('mobile-menu');
		const closeBtn = document.getElementById('close-btn');
		const inner = document.getElementById('inner');
		const backBtns = document.getElementsByClassName('submenu-panel-back-button');
		const panels = Array.from(document.getElementsByClassName("submenu-panel-inactive"));


		// Calculate width based on panels
		//inner.style.width = `${inner.children.length * 100}%`;

		// Open menu
		hamburger.addEventListener('click', () => {
			mobileMenu.style.display = 'block';
			mobileMenu.setAttribute('aria-hidden', 'false');
			inner.style.transform = 'translateX(0)';
		});

		// Close menu
		closeBtn.addEventListener('click', () => {
			mobileMenu.style.display = 'none';
			mobileMenu.setAttribute('aria-hidden', 'true');
		});

		// Back menu
		[...backBtns].forEach(btn => {
			btn.addEventListener('click', () => {
				inner.style.transform = 'translateX(0)';
			});
		})


		// Delegate sliding
		inner.addEventListener('click', e => {
			const btn = e.target.closest('button[data-panel]');
			if (btn) {
				const panelId = btn.getAttribute("data-panel");
				if(panelId){
					panels.forEach(panel => {
						panel.classList.add("submenu-panel-inactive");
					})
					const panel = document.getElementById(panelId);
					panel.classList.remove("submenu-panel-inactive");
					inner.style.transform = `translateX(-${50}%)`;
				}else{
					console.error("Id of menu is missing");
				}
				return;
			}
		});
	})();
</script>

<script>
	(() => {
		let dropdown;
		const $targetEl = document.getElementById('dropdownNavbar');
		const $triggerEl = document.getElementById('dropdownNavbarButton');
		const options = {
			triggerType: 'hover',
			offsetSkidding: 0,
			offsetDistance: 10,
			delay: 0,
		};
		function init () {
			dropdown = new Flowbite.default.Dropdown($targetEl, $triggerEl, options, {});
		}

		function handleToggleMenu() {
			dropdown.toggle();


		}

		$triggerEl.addEventListener("click", handleToggleMenu);
		document.addEventListener("DOMContentLoaded", () => {init();});
	})();



</script>
